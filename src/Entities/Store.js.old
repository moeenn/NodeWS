class Store {
  _db;

  constructor(db) {
    this._db = db;
  }

  close() {
    this._db.disconnect();
  }

  /**
   *  register a new chat between two users 
   * 
  */
  async createChat(userA, userB) {
    const create_chat_query = `
    INSERT INTO chats (room_id)
    values (?);
    `;

    const participants_create_query = `
    INSERT INTO participants (chat_id, user_id)
    VALUES
	    (?, ?),
      (?, ?);
    `;

    const chat = await this._db.query(create_chat_query, [uuidv4()]);
    const chatID = chat.insertId;

    await this._db.query(participants_create_query, [chatID, userA, chatID, userB]);
  }
}

export default Store;